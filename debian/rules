#!/usr/bin/make -f
# vim:noet:ts=4:sw=4:

export DH_VERBOSE=1
export DEST=/usr/share/cfengine3/CoreBase

%:
	dh $@ --with quilt

override_dh_auto_configure:
	./autogen.sh --prefix=${DEST} --datadir=${DEST}

override_dh_auto_test:
	/bin/true

#override_dh_clean:
#	dh_autoreconf_clean
#	dh_clean --exclude=#008.cf#
#
#override_dh_compress:
#	dh_compress -X.cf
#
#override_dh_installinfo:
#
#override_dh_strip:
#	dh_strip --dbg-package=cfengine3-dbg
#
#override_dh_installchangelogs:
#	rm debian/cfengine3/usr/share/doc/cfengine3/ChangeLog
#	dh_installchangelogs
#
###  There is no html documentation
##
#override_dh_installdocs:
#	dh_installdocs
#
override_dh_install:
	dh_testdir
	dh_testroot
	dh_prep
	dh_installdirs

	# Add here commands to install the package into debian/cfengine3.
	$(MAKE) DESTDIR=$(CURDIR)/debian/cfengine3-masterfiles install
#	/bin/rmdir $(CURDIR)/debian/cfengine3/usr/sbin
#	/bin/mv $(CURDIR)/debian/cfengine3/usr/bin $(CURDIR)/debian/cfengine3/usr/sbin
#
#	/bin/rmdir $(CURDIR)/debian/cfengine3/var/lib/cfengine3/inputs
#	/bin/rm $(CURDIR)/debian/cfengine3/usr/lib/*.la
#
#	## Man pages are created with an undocumented flag
#	#
#	/bin/mkdir -p $(CURDIR)/debian/cfengine3/usr/share/man/man8/
#	for p in cf-agent cf-key cf-promises cf-runagent cf-execd cf-serverd cf-monitord; \
#    do \
#        $(CURDIR)/$$p/$$p -M > $(CURDIR)/debian/cfengine3/usr/share/man/man8/$$p.8 ;\
#    done
